<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>صندوق الحكمة - شارك النصيحة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #25D366;
            --secondary: #128C7E;
            --light: #f8f9fa;
            --dark: #343a40;
            --white: #ffffff;
            --info: #17a2b8;
            --bot1-color: #25D366;
            --bot2-color: #5865F2;
            --danger: #dc3545;
        }
        
        body {
            font-family: 'Tajawal', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            color: var(--dark);
        }
        
        .container {
            max-width: 600px;
            margin: 40px auto;
            padding: 0 15px;
        }
        
        .card {
            background: var(--white);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 700;
        }
        
        .header p {
            margin: 10px 0 0;
            opacity: 0.9;
            font-size: 16px;
        }
        
        .header i {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 40px;
            opacity: 0.2;
        }
        
        .info-box {
            background-color: #e7f8ff;
            border-right: 4px solid var(--info);
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            font-size: 15px;
        }
        
        .info-box i {
            color: var(--info);
            margin-left: 8px;
        }
        
        .form-body {
            padding: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.2);
        }
        
        textarea.form-control {
            min-height: 150px;
            resize: vertical;
        }
        
        .btn {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #495057);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #c82333);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }
        
        .btn-danger:hover {
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
        }
        
        .btn i {
            margin-left: 8px;
        }
        
        #status {
            margin-top: 20px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        
        .loading {
            background-color: #e2e3e5;
            color: #383d41;
            border: 1px solid #d6d8db;
        }
        
        .whatsapp-float {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 100;
        }
        
        .whatsapp-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 50%;
            box-shadow: 0 4px 20px rgba(37, 211, 102, 0.3);
            font-size: 30px;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .whatsapp-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(37, 211, 102, 0.4);
        }
        
        .countdown-container {
            display: none;
            padding: 25px;
            text-align: center;
        }
        
        .countdown-container h2 {
            color: var(--secondary);
            margin-bottom: 20px;
        }
        
        .countdown {
            font-size: 36px;
            font-weight: bold;
            color: var(--primary);
            margin: 20px 0;
        }
        
        .countdown-message {
            font-size: 18px;
            margin-bottom: 20px;
        }
        
        .bot-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .bot-option {
            flex: 1;
            text-align: center;
        }
        
        .bot-option input[type="radio"] {
            display: none;
        }
        
        .bot-option label {
            display: block;
            padding: 12px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .bot-option input[type="radio"]:checked + label {
            color: white;
            border-color: transparent;
        }
        
        #bot1:checked + label {
            background: linear-gradient(135deg, var(--bot1-color), #1a9e5a);
        }
        
        #bot2:checked + label {
            background: linear-gradient(135deg, var(--bot2-color), #4752c4);
        }
        
        .bot-option.disabled {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .bot-option label:hover {
            border-color: var(--primary);
        }
        
        .bot-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .bot-name {
            font-weight: 600;
        }
        
        .bot-description {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 4px;
        }
        
        /* إدارة البوتات */
        .admin-section {
            display: none;
            padding: 25px;
        }
        
        .admin-section h2 {
            color: var(--secondary);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .bot-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .bot-status-info {
            flex: 1;
        }
        
        .bot-status-name {
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .bot-status-desc {
            font-size: 14px;
            color: #6c757d;
        }
        
        .bot-status-toggle {
            margin-right: 15px;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .admin-login {
            padding: 25px;
            text-align: center;
        }
        
        .admin-login h2 {
            color: var(--secondary);
            margin-bottom: 20px;
        }
        
        .admin-login-form {
            max-width: 400px;
            margin: 0 auto;
        }
        
        .admin-logout-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--danger);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 20px auto;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .whatsapp-float {
                bottom: 20px;
                left: 20px;
            }
            
            .bot-options {
                flex-direction: column;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="header">
                <i class="fas fa-lightbulb"></i>
                <h1>سردة نجاح</h1>
                <p>شاركنا النصيحة التي تفيد الآخرين</p>
            </div>
            
            <!-- قسم تسجيل الدخول للإدارة -->
            <div id="adminLoginSection" class="admin-login">
                <h2>الدخول إلى لوحة التحكم</h2>
                <div class="admin-login-form">
                    <div class="form-group">
                        <label for="adminPassword">كلمة المرور</label>
                        <input type="password" id="adminPassword" class="form-control" placeholder="أدخل كلمة المرور">
                    </div>
                    <button id="adminLoginBtn" class="btn" onclick="adminLogin()">
                        دخول <i class="fas fa-sign-in-alt"></i>
                    </button>
                    <div id="adminLoginStatus" style="display:none;"></div>
                </div>
            </div>
            
            <!-- قسم إدارة البوتات -->
            <div id="adminSection" class="admin-section">
                <button class="admin-logout-btn" onclick="adminLogout()">
                    تسجيل خروج <i class="fas fa-sign-out-alt"></i>
                </button>
                <h2><i class="fas fa-cogs"></i> إدارة البوتات</h2>
                
                <div class="bot-status">
                    <div class="bot-status-info">
                        <div class="bot-status-name">بوت سردة نجاح</div>
                        <div class="bot-status-desc">مسؤول عن تلقي النصائح ومشاركتها</div>
                    </div>
                    <div class="bot-status-toggle">
                        <label class="switch">
                            <input type="checkbox" id="toggleBot1" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>
                
                <div class="bot-status">
                    <div class="bot-status-info">
                        <div class="bot-status-name">بوت الرسائل العامة</div>
                        <div class="bot-status-desc">مسؤول عن تلقي الرسائل العامة</div>
                    </div>
                    <div class="bot-status-toggle">
                        <label class="switch">
                            <input type="checkbox" id="toggleBot2" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>
                
                <button class="btn btn-secondary" onclick="showUserSection()">
                    العودة إلى القسم الرئيسي <i class="fas fa-arrow-left"></i>
                </button>
            </div>
            
            <!-- قسم المستخدم الرئيسي -->
            <div id="formSection" class="form-body">
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    <strong>كيف تعمل المشاركة؟</strong>
                    <p>يمكنك إرسال نصيحة واحدة فقط يومياً. سيقوم فريقنا بمراجعة جميع النصائح الواردة يوميا واختيار الأفضل منها لنشرها على قناتنا. سيتم نشر النصائح المختارة مع ذكر اسم كاتبها (إذا تم إدخاله). شكراً لمشاركتك!</p>
                </div>
                
                <div class="form-group">
                    <label for="userName">اسمك (اختياري)</label>
                    <input type="text" id="userName" class="form-control" placeholder="اكتب اسمك">
                </div>
                
                <div class="form-group">
                    <label for="tipText">نصيحتك</label>
                    <textarea id="tipText" class="form-control" placeholder="اكتب هنا الرسالة التي تريد مشاركتها معنا..."></textarea>
                </div>
                
                <div class="form-group">
                    <label>اختر القناة المراد الإرسال إليها:</label>
                    <div class="bot-options">
                        <div class="bot-option" id="bot1Option">
                            <input type="radio" id="bot1" name="bot" value="bot1" checked>
                            <label for="bot1">
                                <div class="bot-icon"><img src="/IMG-20250430-WA0045.png" style="width: 100%; border-radius: 8px;"></div>
                                <div class="bot-name">سردة نجاح</div>
                                <div class="bot-description">... </div>
                            </label>
                        </div>
                        <div class="bot-option" id="bot2Option">
                            <input type="radio" id="bot2" name="bot" value="bot2">
                            <label for="bot2">
                                <div class="bot-icon"><i class="fa-solid fa-message"></i></div>
                                <div class="bot-name">الرسائل العامة</div>
                                <div class="bot-description"> ...</div>
                            </label>
                        </div>
                    </div>
                </div>
                
                <button id="submitBtn" class="btn" onclick="sendTipToTelegram()">
                    إرسال النصيحة <i class="fas fa-paper-plane"></i>
                </button>
                
                <div id="status"></div>
                
                <!-- رابط الدخول إلى لوحة التحكم -->
                <div style="text-align: center; margin-top: 20px;">
                    <a href="#" onclick="showAdminLogin()" style="color: var(--secondary); text-decoration: none;">
                        <i class="fas fa-cog"></i> الدخول إلى لوحة التحكم
                    </a>
                </div>
            </div>
            
            <div id="countdownSection" class="countdown-container">
                <h2><i class="fas fa-check-circle"></i> تم إرسال نصيحتك بنجاح!</h2>
                <p class="countdown-message">شكراً لمشاركتك. يمكنك إرسال نصيحة جديدة بعد:</p>
                <div id="countdown" class="countdown">24:00:00</div>
                <button class="btn btn-secondary" onclick="closeCountdown()">
                    إغلاق <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>
    
    <div class="whatsapp-float">
        <a href="https://whatsapp.com/channel/0029VaNb0u79RZAbQJSLVQ21" class="whatsapp-btn" target="_blank">
            <i class="fab fa-whatsapp"></i>
        </a>
    </div>

    <script>
        // إعدادات البوتات و chat_ids
        const botConfig = {
            bot1: {
                token: '7843986073:AAHYaOrepm7ickfzg_NeMB2_F378EwRXZGY',
                chatIds: ['5555170485', '7614635005'],
                enabled: true,
                name: "سردة نجاح",
                description: "مسؤول عن تلقي النصائح ومشاركتها"
            },
            bot2: {
                token: '8206014526:AAGkVFsmS4klK_sSw7zOuhdZPZptQEKO62U',
                chatIds: ['5555170485', '7614635005'],
                enabled: true,
                name: "الرسائل العامة",
                description: "مسؤول عن تلقي الرسائل العامة"
            }
        };

        // كلمة المرور للإدارة (يجب تغييرها)
        const ADMIN_PASSWORD = "admin123";
        
        // مسار ملف الحالة (يجب وضعه بجانب index.html)
        const STATUS_FILE = 'status.json';
        
        // تحميل حالة البوتات من ملف JSON
        async function loadBotStatus() {
            try {
                const response = await fetch(STATUS_FILE + '?t=' + new Date().getTime());
                if (!response.ok) throw new Error("Network response was not ok");
                const status = await response.json();
                
                botConfig.bot1.enabled = status.bot1;
                botConfig.bot2.enabled = status.bot2;
                
                document.getElementById('toggleBot1').checked = status.bot1;
                document.getElementById('toggleBot2').checked = status.bot2;
                
                updateBotOptionsUI();
            } catch (error) {
                console.error("خطأ في تحميل حالة البوتات:", error);
                // استخدام الحالة الافتراضية إذا فشل التحميل
                botConfig.bot1.enabled = true;
                botConfig.bot2.enabled = true;
            }
        }
        
        // حفظ حالة البوتات (للوحة التحكم المحلية)
        function saveLocalBotStatus() {
            const status = {
                bot1: document.getElementById('toggleBot1').checked,
                bot2: document.getElementById('toggleBot2').checked
            };
            
            localStorage.setItem('botStatus', JSON.stringify(status));
            updateBotOptionsUI();
        }
        
        // تحديث واجهة خيارات البوتات
        function updateBotOptionsUI() {
            const bot1Option = document.getElementById('bot1Option');
            const bot2Option = document.getElementById('bot2Option');
            const submitBtn = document.getElementById('submitBtn');
            
            if (botConfig.bot1.enabled) {
                bot1Option.classList.remove('disabled');
                document.getElementById('bot1').disabled = false;
            } else {
                bot1Option.classList.add('disabled');
                document.getElementById('bot1').disabled = true;
                // إذا كان البوت 1 معطلاً والبوت 2 مفعلاً، اختر البوت 2 تلقائياً
                if (document.querySelector('input[name="bot"]:checked').value === 'bot1' && botConfig.bot2.enabled) {
                    document.getElementById('bot2').checked = true;
                }
            }
            
            if (botConfig.bot2.enabled) {
                bot2Option.classList.remove('disabled');
                document.getElementById('bot2').disabled = false;
            } else {
                bot2Option.classList.add('disabled');
                document.getElementById('bot2').disabled = true;
                // إذا كان البوت 2 معطلاً والبوت 1 مفعلاً، اختر البوت 1 تلقائياً
                if (document.querySelector('input[name="bot"]:checked').value === 'bot2' && botConfig.bot1.enabled) {
                    document.getElementById('bot1').checked = true;
                }
            }
            
            // تعطيل زر الإرسال إذا لم يكن هناك بوتات مفعلة
            if (!botConfig.bot1.enabled && !botConfig.bot2.enabled) {
                submitBtn.disabled = true;
                submitBtn.title = "جميع القنوات معطلة حالياً";
            } else {
                submitBtn.disabled = false;
                submitBtn.title = "";
            }
        }
        
        // تسجيل دخول المدير
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            const statusElement = document.getElementById('adminLoginStatus');
            
            if (password === ADMIN_PASSWORD) {
                // إخفاء قسم تسجيل الدخول وإظهار قسم الإدارة
                document.getElementById('adminLoginSection').style.display = 'none';
                document.getElementById('adminSection').style.display = 'block';
                document.getElementById('formSection').style.display = 'none';
                document.getElementById('countdownSection').style.display = 'none';
                
                // تحميل حالة البوتات المحفوظة
                loadBotStatus();
            } else {
                statusElement.textContent = 'كلمة المرور غير صحيحة';
                statusElement.className = 'error';
                statusElement.style.display = 'block';
            }
        }
        
        // تسجيل خروج المدير
        function adminLogout() {
            // إخفاء قسم الإدارة وإظهار قسم المستخدم الرئيسي
            document.getElementById('adminSection').style.display = 'none';
            document.getElementById('adminLoginSection').style.display = 'none';
            document.getElementById('formSection').style.display = 'block';
            
            // مسح حقل كلمة المرور
            document.getElementById('adminPassword').value = '';
        }
        
        // عرض واجهة تسجيل الدخول للإدارة
        function showAdminLogin() {
            document.getElementById('adminLoginSection').style.display = 'block';
            document.getElementById('adminSection').style.display = 'none';
            document.getElementById('formSection').style.display = 'none';
            document.getElementById('countdownSection').style.display = 'none';
        }
        
        // العودة إلى قسم المستخدم الرئيسي
        function showUserSection() {
            document.getElementById('adminLoginSection').style.display = 'none';
            document.getElementById('adminSection').style.display = 'none';
            document.getElementById('formSection').style.display = 'block';
            
            // حفظ حالة البوتات عند الخروج
            saveLocalBotStatus();
        }
        
        // تهيئة الصفحة عند التحميل
        document.addEventListener('DOMContentLoaded', function() {
            loadBotStatus();
            checkDailyLimit();
            
            // إعداد أحداث التبديل للبوتات
            document.getElementById('toggleBot1').addEventListener('change', saveLocalBotStatus);
            document.getElementById('toggleBot2').addEventListener('change', saveLocalBotStatus);
            
            // إخفاء قسم الإدارة افتراضياً
            document.getElementById('adminLoginSection').style.display = 'none';
            document.getElementById('adminSection').style.display = 'none';
        });

        function checkDailyLimit() {
            const lastSubmissionDate = localStorage.getItem('lastSubmissionDate');
            const today = new Date().toDateString();
            const submitBtn = document.getElementById('submitBtn');
            const formSection = document.getElementById('formSection');
            const countdownSection = document.getElementById('countdownSection');
            
            if (lastSubmissionDate === today) {
                formSection.style.display = 'none';
                countdownSection.style.display = 'block';
                startCountdown();
            }
        }

        function closeCountdown() {
            const formSection = document.getElementById('formSection');
            const countdownSection = document.getElementById('countdownSection');
            
            formSection.style.display = 'block';
            countdownSection.style.display = 'none';
        }

        function startCountdown() {
            const countdownElement = document.getElementById('countdown');
            const now = new Date();
            const midnight = new Date();
            midnight.setHours(24, 0, 0, 0); // منتصف الليل القادم
            
            const diff = midnight - now;
            
            const countdownInterval = setInterval(() => {
                const now = new Date();
                const diff = midnight - now;
                
                if (diff <= 0) {
                    clearInterval(countdownInterval);
                    countdownElement.textContent = "00:00:00";
                    localStorage.removeItem('lastSubmissionDate');
                    closeCountdown();
                    return;
                }
                
                const hours = Math.floor(diff / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                countdownElement.textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        async function sendTipToTelegram() {
            // تحميل أحدث حالة للبوتات
            await loadBotStatus();
            
            const tipText = document.getElementById('tipText').value.trim();
            const userName = document.getElementById('userName').value.trim();
            const selectedBot = document.querySelector('input[name="bot"]:checked').value;
            const statusElement = document.getElementById('status');
            const submitBtn = document.getElementById('submitBtn');
            const formSection = document.getElementById('formSection');
            const countdownSection = document.getElementById('countdownSection');
            
            const lastSubmissionDate = localStorage.getItem('lastSubmissionDate');
            const today = new Date().toDateString();
            
            if (lastSubmissionDate === today) {
                showStatus('لقد قمت بإرسال نصيحة اليوم بالفعل. يمكنك إرسال نصيحة جديدة غداً.', 'warning');
                return;
            }
            
            statusElement.style.display = 'none';
            
            if (!tipText) {
                showStatus('الرجاء إدخال نصيحة قبل الإرسال', 'error');
                return;
            }
            
            // التحقق من حالة البوت المحدد
            if (!botConfig[selectedBot].enabled) {
                showStatus('هذه القناة غير متاحة حاليًا للإرسال. يرجى اختيار قناة أخرى.', 'error');
                return;
            }
            
            showStatus('جاري إرسال النصيحة...', 'loading');
            submitBtn.disabled = true;
            
            try {
                let messageText = `📨 <b>نصيحة جديدة</b>\n\n`;
                messageText += `${tipText}\n\n`;
                messageText += userName ? `من: <b>${userName}</b>` : `من: <b>مستخدم مجهول</b>`;
                
                const bot = botConfig[selectedBot];
                let allSuccess = true;
                
                for (const chatId of bot.chatIds) {
                    const response = await fetch(`https://api.telegram.org/bot${bot.token}/sendMessage`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            chat_id: chatId,
                            text: messageText,
                            parse_mode: 'HTML'
                        })
                    });
                    
                    const result = await response.json();
                    if (!result.ok) {
                        allSuccess = false;
                        console.error('Error sending to chat_id:', chatId, result.description);
                    }
                }
                
                if (allSuccess) {
                    localStorage.setItem('lastSubmissionDate', today);
                    formSection.style.display = 'none';
                    countdownSection.style.display = 'block';
                    startCountdown();
                    
                    document.getElementById('tipText').value = '';
                    document.getElementById('userName').value = '';
                } else {
                    showStatus('تم إرسال النصيحة لبعض القنوات، ولكن حدث خطأ في بعضها', 'warning');
                    submitBtn.disabled = false;
                }
            } catch (error) {
                console.error('Error:', error);
                showStatus('حدث خطأ في الاتصال. يرجى المحاولة لاحقاً.', 'error');
                submitBtn.disabled = false;
            }
        }
        
        function showStatus(message, type) {
            const statusElement = document.getElementById('status');
            statusElement.textContent = message;
            statusElement.className = type;
            statusElement.style.display = 'block';
        }
    </script>
</body>
</html>
